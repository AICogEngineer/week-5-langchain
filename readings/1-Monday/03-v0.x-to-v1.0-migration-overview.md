# v0.x to v1.0 Migration Overview

## Learning Objectives
- Identify the critical breaking changes between LangChain v0.x and v1.0
- Recognize deprecated patterns that should no longer be used
- Understand why these changes were made
- Know the v1.0 equivalents for common v0.x patterns

## Why This Matters

If you've worked with LangChain before—or are learning from tutorials that predate v1.0—you'll encounter patterns that **no longer work**. LangChain Expression Language (LCEL), `create_react_agent`, `ConversationBufferMemory`, and many other familiar constructs have been **deprecated and removed**.

Understanding these breaking changes protects you from frustration and wasted debugging time. For our production journey, this knowledge ensures you build on the current, supported foundation.

## The Concept

### Why the Major Rewrite?

LangChain's v0.x architecture evolved organically, leading to several problems:

1. **LCEL (LangChain Expression Language)** was powerful but confusing for newcomers
2. **Too many ways to do the same thing** made code inconsistent
3. **Complex chain compositions** required understanding low-level internals
4. **Memory abstractions** were disconnected from agent execution

The v1.0 rewrite unified these into a cleaner, more coherent design built on LangGraph.

### Critical Breaking Changes

#### 1. LCEL is Gone

**v0.x (DEPRECATED):**
```python
# ❌ THIS NO LONGER WORKS
from langchain_core.prompts import ChatPromptTemplate
from langchain_openai import ChatOpenAI
from langchain_core.output_parsers import StrOutputParser

prompt = ChatPromptTemplate.from_messages([...])
model = ChatOpenAI()
parser = StrOutputParser()

# The pipe operator is LCEL - deprecated!
chain = prompt | model | parser
result = chain.invoke({"input": "Hello"})
```

**v1.0 (CURRENT):**
```python
# ✅ Use init_chat_model and direct invocation
from langchain import init_chat_model

model = init_chat_model("openai:gpt-4o-mini")
result = model.invoke([{"role": "user", "content": "Hello"}])
```

For complex workflows, use `create_agent()` with tools instead of chains.

#### 2. create_react_agent is Deprecated

**v0.x (DEPRECATED):**
```python
# ❌ THIS NO LONGER WORKS
from langchain.agents import create_react_agent, AgentExecutor
from langchain import hub

prompt = hub.pull("hwchase17/react")
agent = create_react_agent(llm, tools, prompt)
agent_executor = AgentExecutor(agent=agent, tools=tools)
result = agent_executor.invoke({"input": "Hello"})
```

**v1.0 (CURRENT):**
```python
# ✅ Use create_agent - much simpler!
from langchain.agents import create_agent

agent = create_agent(
    model="openai:gpt-4o-mini",
    tools=tools,
    system_prompt="You are a helpful assistant.",
    name="my_agent"
)
result = agent.invoke({"messages": [{"role": "user", "content": "Hello"}]})
```

Notice:
- No `AgentExecutor` wrapper needed
- No prompt hub dependency
- No separate LLM instantiation
- Direct, clean API

#### 3. Memory Classes are Deprecated

**v0.x (DEPRECATED):**
```python
# ❌ THIS NO LONGER WORKS
from langchain.memory import ConversationBufferMemory
from langchain.chains import ConversationChain

memory = ConversationBufferMemory()
conversation = ConversationChain(llm=llm, memory=memory)
```

**v1.0 (CURRENT):**
```python
# ✅ Use checkpointers for memory
from langchain.agents import create_agent
from langgraph.checkpoint.memory import InMemorySaver

agent = create_agent(
    model="openai:gpt-4o-mini",
    tools=[],
    checkpointer=InMemorySaver(),  # Memory built-in!
    name="conversational_agent"
)

# Use thread_id to maintain conversation context
config = {"configurable": {"thread_id": "user_123"}}
result = agent.invoke({"messages": [{"role": "user", "content": "Hello"}]}, config)
```

Memory is now integrated directly into agents via checkpointers.

#### 4. Chains are Deprecated

**v0.x (DEPRECATED):**
```python
# ❌ THIS NO LONGER WORKS
from langchain.chains import LLMChain, SimpleSequentialChain, RetrievalQA

chain = LLMChain(llm=llm, prompt=prompt)
qa_chain = RetrievalQA.from_chain_type(llm=llm, retriever=retriever)
```

**v1.0 (CURRENT):**
```python
# ✅ Use agents with RAG tools instead
from langchain.agents import create_agent
from langchain_core.tools import tool

@tool
def search_documents(query: str) -> str:
    """Search knowledge base for relevant information."""
    docs = vectorstore.similarity_search(query, k=3)
    return "\n\n".join(doc.page_content for doc in docs)

agent = create_agent(
    model="openai:gpt-4o-mini",
    tools=[search_documents],
    system_prompt="Answer questions using the search tool.",
    name="qa_agent"
)
```

#### 5. Agent Name is Now Required

**v1.0 Requirement:**
```python
# ❌ WRONG - Missing name
agent = create_agent(model="openai:gpt-4o-mini", tools=[])

# ✅ CORRECT - Always provide a name
agent = create_agent(
    model="openai:gpt-4o-mini",
    tools=[],
    name="my_agent"  # Required for tracing and debugging
)
```

The `name` parameter is essential for:
- LangSmith tracing
- Multi-agent identification
- Debugging and logging

### Migration Cheat Sheet

| v0.x Pattern | v1.0 Replacement |
|--------------|------------------|
| `chain = prompt \| model \| parser` | `model.invoke()` or `create_agent()` |
| `create_react_agent()` | `create_agent()` |
| `AgentExecutor` | Not needed—`create_agent()` returns executable |
| `ConversationBufferMemory` | `InMemorySaver` checkpointer |
| `LLMChain`, `SimpleSequentialChain` | `create_agent()` with tools |
| `RetrievalQA` | Agent with RAG tool |
| `hub.pull("hwchase17/react")` | `system_prompt` parameter |
| Separate `llm = ChatOpenAI()` | `model="openai:gpt-4o-mini"` string |

### Common Migration Errors

**Error**: `ImportError: cannot import name 'create_react_agent'`
**Fix**: Use `from langchain.agents import create_agent` instead

**Error**: `TypeError: 'ChatOpenAI' object is not callable`
**Fix**: Use `model.invoke()` not `model()`, or use `init_chat_model()` helper

**Error**: `AttributeError: 'NoneType' object has no attribute 'content'`
**Fix**: Check that you're accessing `result["messages"][-1].content` not `result.content`

## Code Example

Here's a side-by-side migration example:

```python
"""
Migration Example: v0.x to v1.0
LangChain Version: v1.0+
"""

# ============================================================
# ❌ OLD v0.x APPROACH (DOES NOT WORK)
# ============================================================
# from langchain.agents import create_react_agent, AgentExecutor
# from langchain_openai import ChatOpenAI
# from langchain.memory import ConversationBufferMemory
# from langchain import hub
#
# llm = ChatOpenAI(model="gpt-4o-mini")
# memory = ConversationBufferMemory(return_messages=True)
# prompt = hub.pull("hwchase17/react")
# agent = create_react_agent(llm, tools, prompt)
# executor = AgentExecutor(agent=agent, tools=tools, memory=memory)
# result = executor.invoke({"input": "Hello"})

# ============================================================
# ✅ NEW v1.0 APPROACH (USE THIS)
# ============================================================
from langchain.agents import create_agent
from langchain_core.tools import tool
from langgraph.checkpoint.memory import InMemorySaver

@tool
def get_current_time() -> str:
    """Get the current time. Use when asked about the time."""
    from datetime import datetime
    return datetime.now().strftime("%H:%M:%S")

# Create agent with memory - clean and simple!
agent = create_agent(
    model="openai:gpt-4o-mini",
    tools=[get_current_time],
    system_prompt="You are a helpful assistant that can tell time.",
    checkpointer=InMemorySaver(),
    name="time_agent"
)

# Invoke with thread for conversation memory
config = {"configurable": {"thread_id": "user_001"}}
result = agent.invoke(
    {"messages": [{"role": "user", "content": "What time is it?"}]},
    config
)

print(result["messages"][-1].content)
```

## Key Takeaways

- **LCEL (pipe operators) is gone**: Don't use `|` for chain composition
- **`create_react_agent` is deprecated**: Use `create_agent()` instead
- **Memory classes are deprecated**: Use `InMemorySaver` checkpointer
- **Chains are deprecated**: Use agents with tools
- **Agent names are required**: Always provide a `name` parameter
- **Simpler is better**: v1.0 requires dramatically less code

## Additional Resources

- [LangChain v1.0 Migration Guide](https://docs.langchain.com/oss/python/langchain/migration)
- [LangChain v1.0 Release Notes](https://blog.langchain.dev/langchain-v1-0/)
- [Deprecated Features List](https://docs.langchain.com/oss/python/langchain/deprecations)
